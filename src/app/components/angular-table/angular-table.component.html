<p-table
  #dt
  [value]="values"
  dataKey="id"
  [rowHover]="true"
  [rows]="10"
  [resizableColumns]="true"
  styleClass="p-datatable-gridlines"
  [paginator]="true"
  [showCurrentPageReport]="true"
  [rowsPerPageOptions]="[10, 25, 50]"
  [loading]="loading"
  [columns]="selectedColumns"
  currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
  [filterDelay]="0"
  [globalFilterFields]="['name.first', 'name.last', 'age', 'company', 'email', 'address']"
>
  <ng-template pTemplate="caption">
    <div class="flex justify-content-between gap-2 w-full flex-wrap">
      <p-multiSelect display="chip"
                     [options]="cols"
                     [(ngModel)]="selectedColumns"
                     optionLabel="header"
                     selectedItemsLabel="{0} columns selected"
                     [style]="{ 'min-width': '200px' }"
                     placeholder="Choose Columns"/>

      <div class="flex justify-content-end gap-2">
        <p-button [outlined]="true" icon="pi pi-filter-slash" label="Clear" (click)="clear(dt)"/>
        <input pInputText type="text" #tableSearchInput
               [(ngModel)]="searchValue"
               (input)="dt.filterGlobal(tableSearchInput.value, 'contains')"
               placeholder="Search "/>
      </div>
    </div>
  </ng-template>

  <ng-template pTemplate="header" let-columns>
    <tr>
      @for (column of columns; track column) {
        @if (column.sortable) {
          <th pSortableColumn="{{column.field}}" style="min-width: 5rem">
            <div class="flex justify-between items-center">
              {{column.header}}
              <p-sortIcon field="{{column.field}}"/>
              <p-columnFilter type="{{column.type}}" field="{{column.field}}" display="menu" class="ml-auto"/>
            </div>
          </th>
        } @else if(column.field === 'isActive')  {
          <th style="min-width: 5rem">
            <div class="flex justify-between items-center">
              isActive
              <p-columnFilter type="boolean"
                              field="isActive"
                              [showMenu]="false"
                              [showClearButton]="false"
                              matchMode="equals"
              ></p-columnFilter>
            </div>
          </th>
        } @else if(column.field === 'tags')  {
          <th style="min-width: 10rem">
            <div class="flex justify-between items-center">
              Tags
<!--              <p-columnFilter field="tags" matchMode="equals" display="menu" class="ml-auto">-->
<!--                <ng-template #filter let-value let-filter="filterCallback">-->
<!--                  <p-dropdown [options]=""-->
<!--                              [(ngModel)]="value"-->
<!--                              (onChange)="filter($event.value)"-->
<!--                              placeholder="Select tag">-->
<!--                    <ng-template let-option #tag>-->
<!--                      <p-tag [value]="option"/>-->
<!--                    </ng-template>-->
<!--                  </p-dropdown>-->
<!--                </ng-template>-->
<!--              </p-columnFilter>-->
            </div>
          </th>
        }
      }
    </tr>
  </ng-template>

  <ng-template pTemplate="body" let-item>
    <tr class="p-selectable-row">
      @for (column of selectedColumns; track column) {
        <td>
        @if (column.field === 'name.first') {
          <div class="flex items-center gap-2">
            <img alt="picture"
                 src="{{item.picture}}" width="32" style="vertical-align: middle" />
            <span class="ml-1 align-middle">{{ item.name.first }}</span>
          </div>
        } @else if (column.field === 'tags') {
          @for (tag of item.tags; track tag) {
            <span># {{tag}}</span>
          }
        } @else if (column.field === 'balance') {
          <span>{{ item.balance | currency: 'USD' }}</span>
        } @else {
          {{ item[column.field] }}
        }
        </td>
      }

    </tr>
  </ng-template>

<!--  <ng-template #emptymessage>-->
<!--    <tr>-->
<!--      <td colspan="{{selectedColumns?.length}}">No values found</td>-->
<!--    </tr>-->
<!--  </ng-template>-->

</p-table>
